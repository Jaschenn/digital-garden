/* Custom style overrides */
/* This file is for custom style overrides */

/* ============================================
   全局基础优化
   ============================================ */
:root {
  --dg-filetree-width: 280px; /* 稍微加宽侧边栏 */
  --dg-filetree-collapsed-width: 50px;
  --transition-speed: 0.3s;
  --transition-ease: cubic-bezier(0.25, 0.8, 0.25, 1);
}

body {
  background-color: var(--background-primary);
  /* 确保无滚动条跳动 */
  overflow-y: scroll; 
}

/* ============================================
   左侧文件树样式 (Obsidian Publish 风格)
   ============================================ */

.filetree-wrapper {
  background-color: var(--background-secondary) !important;
  border-right: 1px solid var(--background-modifier-border);
  width: var(--dg-filetree-width) !important;
  transition: width var(--transition-speed) var(--transition-ease);
  z-index: 100;
  display: flex;
  flex-direction: column;
}

/* 收起状态的 Wrapper */
.filetree-wrapper.filetree-collapsed {
  width: var(--dg-filetree-collapsed-width) !important;
}

.filetree-sidebar {
  width: 100% !important;
  height: 100% !important;
  padding: 0 !important;
  display: flex !important;
  flex-direction: column !important;
  overflow: hidden;
  background: transparent !important;
}

/* 顶部控制栏 */
.filetree-top-controls {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px;
  min-height: 60px;
  border-bottom: 1px solid transparent; /* 可选分隔线 */
}

/* 站点标题 */
.site-title-link {
  flex: 1;
  overflow: hidden;
  white-space: nowrap;
  margin-right: 10px;
}

.site-title-link h1 {
  font-size: 1.1rem !important;
  font-weight: 600 !important;
  margin: 0 !important;
  color: var(--text-normal) !important;
  text-align: left !important;
  text-overflow: ellipsis;
  overflow: hidden;
}

/* 按钮组 */
.filetree-buttons {
  display: flex;
  align-items: center;
  gap: 4px;
  flex-shrink: 0;
}

/* 按钮基础样式 */
.filetree-toggle-button,
.theme-toggle-button {
  width: 30px;
  height: 30px;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: transparent;
  border-radius: 4px;
  cursor: pointer;
  color: var(--text-muted);
  transition: all 0.2s ease;
  border: none;
}

.filetree-toggle-button:hover,
.theme-toggle-button:hover {
  background-color: var(--background-modifier-hover);
  color: var(--text-normal);
}

.filetree-toggle-button i,
.theme-toggle-button i {
  width: 18px;
  height: 18px;
}

/* 收起状态下的顶部栏调整 */
.filetree-wrapper.filetree-collapsed .filetree-top-controls {
  flex-direction: column;
  padding: 12px 0;
  gap: 12px;
  justify-content: flex-start;
}

.filetree-wrapper.filetree-collapsed .filetree-buttons {
  flex-direction: column;
}

/* 主题切换图标逻辑 */
.theme-toggle-button .theme-icon {
  display: none;
}
.theme-toggle-button.is-dark .theme-icon-dark {
  display: block;
}
.theme-toggle-button.is-light .theme-icon-light {
  display: block;
}
/* 默认状态防止闪烁 */
.theme-toggle-button:not(.is-dark):not(.is-light) .theme-icon-auto {
    display: block;
}

/* 搜索栏容器 */
.search-wrapper {
  padding: 0 16px 10px 16px;
}

.search-button {
  width: 100% !important;
  margin: 0 !important;
  background-color: var(--background-primary) !important;
  border: 1px solid var(--background-modifier-border) !important;
  color: var(--text-muted) !important;
  height: 32px;
  font-size: 0.85rem;
  border-radius: 6px;
  justify-content: flex-start;
  padding-left: 10px;
}
.search-button:hover {
  border-color: var(--text-accent) !important;
}

/* 文件树内容区 */
.filetree-content {
  flex: 1;
  overflow-y: auto;
  padding: 0 8px 10px 8px !important; /* 给左右留点空隙 */
}

/* 文件夹行 */
.foldername-wrapper {
  padding: 6px 8px;
  border-radius: 4px;
  color: var(--text-muted);
  font-size: 0.9rem;
  margin: 1px 0;
}
.foldername-wrapper:hover {
  background-color: var(--background-modifier-hover);
  color: var(--text-normal);
}

/* 笔记链接行 */
.notelink {
  padding: 0 !important;
  margin: 1px 0 !important;
  border-left: none !important; /* 移除原来的左边框指示器 */
  background: transparent !important;
}

.notelink a.filename {
  display: flex;
  align-items: center;
  padding: 6px 8px;
  border-radius: 4px;
  width: 100%;
  color: var(--text-muted) !important;
  font-size: 0.9rem !important;
  transition: all 0.1s ease;
  border-left: none !important;
}

.notelink a.filename:hover {
  background-color: var(--background-modifier-hover);
  color: var(--text-normal) !important;
  text-decoration: none !important;
}

/* 激活状态的笔记 */
.notelink.active-note a.filename {
  background-color: var(--interactive-accent);
  color: white !important;
  font-weight: 500;
}

/* 修复激活状态下的图标颜色 */
.notelink.active-note a.filename svg,
.notelink.active-note a.filename i {
  color: white !important;
  opacity: 1 !important;
}

/* 文件树层级缩进 */
.filelist {
  border-left: 1px solid var(--background-modifier-border);
  margin-left: 14px;
  padding-left: 0;
}
.folder > .filelist {
    margin-left: 12px; /* 第一级缩进稍微小一点 */
}

/* ============================================
   右侧内容区适配
   ============================================ */

.content {
  /* 当左侧存在时，内容区自动适应，但考虑到 filetree 是 fixed 的 */
  /* 需要配合 JavaScript 或使用 padding-left 策略 */
  /* 这里我们依赖 style.scss 中的媒体查询，但需要调整数值以匹配新的宽度 */
}

@media (min-width: 1400px) {
  .filetree-wrapper {
    width: var(--dg-filetree-width);
  }
  .content {
    /* 280px width + 左右间距 */
    margin-left: 320px; 
    max-width: calc(100vw - 360px - var(--dg-sidebar-width, 300px)); 
  }
}

/* 中等屏幕适配 */
@media (min-width: 1000px) and (max-width: 1400px) {
  .content {
    margin-left: 300px; /* 留出侧边栏空间 */
    margin-right: 40px;
    max-width: none;
  }
}

/* ============================================
   暗色/亮色模式特定微调
   ============================================ */
body.theme-dark {
    --background-modifier-hover: rgba(255, 255, 255, 0.08);
    --background-modifier-border: rgba(255, 255, 255, 0.1);
}
body.theme-light {
    --background-modifier-hover: rgba(0, 0, 0, 0.05);
    --background-modifier-border: rgba(0, 0, 0, 0.1);
}
